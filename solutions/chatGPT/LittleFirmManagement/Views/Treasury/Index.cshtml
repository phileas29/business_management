@{
    int selectedGranularity = (int)ViewData["SelectedGranularity"];
    decimal[,] data = (decimal[,])ViewData["Data"];
    List<string> labels = (List<string>)ViewData["Labels"];
}
<h1>Treasury</h1>


<div class="container">
    <div class="row">
        <div class="col-12">
            <div class="table-responsive">
                <table class="table table-bordered">
                    <thead>
                        <tr>
                            <th></th>
                            @for (int i = 0; i < data.GetLength(1); i++)
                            {
                                DateTime startDate = ((DateTime)ViewData["Begin"]).AddMonths(i * (int)Math.Pow(2, selectedGranularity + 1));
                                <th>@startDate.ToString("MMMM yyyy")</th>
                            }
                        </tr>
                    </thead>
                    <tbody>
                        @for (int row = 0; row < data.GetLength(0); row++)
                        {
                            <tr>
                                <th>@labels[row]</th>
                                @for (int month = 0; month < data.GetLength(1); month++)
                                {
                                    decimal amount = data[row,month];
                                    if (amount == 0)
                                    {
                                        <td></td>
                                    } else {
                                        <td>@amount.ToString("0.00")</td>
                                    }
                                }
                            </tr>
                        }
                    </tbody>
                </table>
            </div>


            <!-- Pagination controls -->
            <nav aria-label="Page navigation">
                <ul class="pagination justify-content-center">
                    @foreach (KeyValuePair<int, string> g in ViewBag.GranularityMapping)
                    {
                        <li class="page-item @(g.Key == @selectedGranularity ? "active" : "")">
                            <a class="page-link" href="/Treasury/Index?selectedGranularity=@(g.Key)">@(g.Value)</a>
                        </li>
                    }
                </ul>
            </nav>
        </div>
    </div>
</div>